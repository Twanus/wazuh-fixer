---
# handlers file for win_rename_admin_account
- name: Win_rename_admin_account_verify_name
  ansible.windows.win_shell: |
    Start-Sleep -Seconds 2
    $admin = Get-CimInstance -Query "SELECT * FROM Win32_UserAccount WHERE LocalAccount = TRUE AND SID LIKE 'S-1-5-21-%-500'" -ErrorAction SilentlyContinue
    if ($admin) {
      Write-Output $admin.Name
    } else {
      Write-Output "NotFound"
    }
  register: win_rename_admin_account_verify_name
  changed_when: false
