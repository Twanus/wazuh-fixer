---
# handlers file for win_account_lockout_duration
- name: Win_account_lockout_duration_verify_lockout_duration
  ansible.windows.win_shell: |
    Start-Sleep -Seconds 2
    secedit /export /cfg $env:TEMP\secpol.cfg 2>&1 | Out-Null
    $content = Get-Content $env:TEMP\secpol.cfg | Select-String "LockoutDuration"
    Remove-Item $env:TEMP\secpol.cfg -ErrorAction SilentlyContinue
    if ($content) {
      $value = ($content -split '=')[1].Trim()
      Write-Output $value
    } else {
      Write-Output "0"
    }
  register: win_account_lockout_duration_verify_lockout_duration
  changed_when: false
